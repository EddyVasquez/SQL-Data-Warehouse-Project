/*
=========================================================

Create Database and Schemas

=========================================================

Script Purpose:

The script creates a new database named 'DataWarehouse' after checking if it already exists. 
If the database exists, it is dropped and created. Additionally, the script sets up three schemas
within the database: 'betta', 'gamma', 'delta'.

WARNING:

Running this script will drop the entore 'DataWarehouse' database if it exists.
All dta in the database will be permanently delted. Procees with caution and ensure you have proper
backups before running this script.

*/


USE master;

IF EXISTS (SELECT * FROM sys.databases WHERE name = 'DataWarehouse')
BEGIN
    ALTER DATABASE DataWarehouse SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
    DROP DATABASE DataWarehouse;
END
GO

CREATE DATABASE DataWarehouse;
GO

USE DataWarehouse;
GO

    CREATE SCHEMA betta;
    GO
    CREATE SCHEMA gamma;
    GO
    CREATE SCHEMA delta;
    GO
        
